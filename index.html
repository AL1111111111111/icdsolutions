<!DOCTYPE html>
<html>
<head>
    <title>Access Redirect</title>
</head>
<body>
    <script>
        const params = new URLSearchParams(window.location.search);
        const w = params.get('w') || '26'; // Default to 26 if missing
        const s = params.get('s');
        const c = params.get('c');
        const u = params.get('u') || 'User';
        
        if (s && c) {
            // encodeURIComponent ensures spaces/special chars don't break the link
            const appLink = `accessapp://credentials?wiegand=${encodeURIComponent(w)}&site_code=${encodeURIComponent(s)}&card_id=${encodeURIComponent(c)}&user=${encodeURIComponent(u)}`;
            
            window.location.href = appLink;
        
            setTimeout(() => {
                document.body.innerHTML = `
                    <div style="text-align:center; padding-top:50px; font-family:sans-serif;">
                        <h2>Opening Access App...</h2>
                        <p>Wiegand: ${w} | Site: ${s} | Card: ${c}</p>
                        <a href="${appLink}" style="padding:15px 25px; background:#007bff; color:white; text-decoration:none; border-radius:5px; display:inline-block;">Open App Manually</a>
                    </div>`;
            }, 1000);
        } else {
            document.body.innerHTML = "<h2>Error: Site Code (s) and Card ID (c) are required.</h2>";
        }
    </script>
</body>
</html>
